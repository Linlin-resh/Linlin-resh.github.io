<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" dir="{{ .Site.Language.LanguageDirection | default "auto" }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    {{- if .IsHome }}
        <meta name="description" content="{{ .Site.Params.description | default .Site.Params.subtitle }}">
    {{- else }}
        <meta name="description" content="{{ .Params.description | default .Summary }}">
    {{- end }}
    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} - {{ .Site.Title }}{{ end }}</title>
    
    <!-- 引入侧边栏 -->
    {{ partial "sidebar.html" . }}
    
    <!-- PaperMod 主题的默认样式 -->
    {{ $style := resources.Get "css/main.css" | resources.ToCSS | resources.Minify }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">
    
    <!-- 自定义样式 -->
    <style>
        /* 确保主内容区域不被侧边栏遮挡 */
        .main-content {
            margin-left: 280px;
            padding: 20px;
            max-width: calc(100% - 280px);
        }
        
        @media (max-width: 1200px) {
            .main-content {
                margin-left: 250px;
                max-width: calc(100% - 250px);
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                max-width: 100%;
            }
        }
    </style>
</head>

<body>
    <!-- 侧边栏 -->
    {{ partial "sidebar.html" . }}
    
    <!-- 主内容区域 -->
    <main class="main-content">
        <!-- 顶部导航 -->
        <header class="site-header">
            <div class="header-content">
                <h1 class="site-title">
                    <a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a>
                </h1>
                <nav class="main-nav">
                    {{ range .Site.Menus.main }}
                        <a href="{{ .URL }}" class="nav-link">{{ .Name }}</a>
                    {{ end }}
                </nav>
            </div>
        </header>
        
        <!-- 页面内容 -->
        <div class="page-content">
            {{ block "main" . }}{{ end }}
        </div>
        
        <!-- 页脚 -->
        <footer class="site-footer">
            <p>&copy; {{ now.Year }} {{ .Site.Title }}. Built with Hugo and PaperMod theme.</p>
        </footer>
    </main>
    
    <!-- 移动端侧边栏切换按钮 -->
    <button class="sidebar-toggle" onclick="toggleSidebar()">
        <span>☰</span>
    </button>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('open');
        }
        
        // 在移动端点击外部区域关闭侧边栏
        document.addEventListener('click', function(event) {
            const sidebar = document.querySelector('.sidebar');
            const sidebarToggle = document.querySelector('.sidebar-toggle');
            
            if (window.innerWidth <= 768) {
                if (!sidebar.contains(event.target) && !sidebarToggle.contains(event.target)) {
                    sidebar.classList.remove('open');
                }
            }
        });
    </script>
</body>

</html>
