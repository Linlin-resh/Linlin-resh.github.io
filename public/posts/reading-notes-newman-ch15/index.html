<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks | Notes on AI4Science &amp; Graph Theory</title>
<meta name="keywords" content="reading-notes, network-theory, multilayer-networks, multiplex-networks, network-analysis">
<meta name="description" content="Study notes for Chapter 15 of Newman&#39;s &#39;Networks: An Introduction&#39; covering multilayer networks, multiplex networks, and their analysis">
<meta name="author" content="Linlin-resh">
<link rel="canonical" href="https://Linlin-resh.github.io/posts/reading-notes-newman-ch15/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css" integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://Linlin-resh.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://Linlin-resh.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Linlin-resh.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://Linlin-resh.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://Linlin-resh.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://Linlin-resh.github.io/posts/reading-notes-newman-ch15/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="https://Linlin-resh.github.io/css/math-enhancement.css"><script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['ams', 'newcommand', 'configmacros']}
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      ignoreHtmlClass: 'tex2jax_ignore',
      processHtmlClass: 'tex2jax_process'
    },
    loader: {
      load: ['[tex]/ams', '[tex]/newcommand', '[tex]/configmacros']
    }
  };
</script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@300;400;500;600;700&family=Source+Serif+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<meta property="og:url" content="https://Linlin-resh.github.io/posts/reading-notes-newman-ch15/">
  <meta property="og:site_name" content="Notes on AI4Science & Graph Theory">
  <meta property="og:title" content="Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks">
  <meta property="og:description" content="Study notes for Chapter 15 of Newman&#39;s &#39;Networks: An Introduction&#39; covering multilayer networks, multiplex networks, and their analysis">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-29T00:00:00+00:00">
    <meta property="article:tag" content="Reading-Notes">
    <meta property="article:tag" content="Network-Theory">
    <meta property="article:tag" content="Multilayer-Networks">
    <meta property="article:tag" content="Multiplex-Networks">
    <meta property="article:tag" content="Network-Analysis">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks">
<meta name="twitter:description" content="Study notes for Chapter 15 of Newman&#39;s &#39;Networks: An Introduction&#39; covering multilayer networks, multiplex networks, and their analysis">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://Linlin-resh.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Reading Notes: Newman's Networks Chapter 15 - Multilayer Networks",
      "item": "https://Linlin-resh.github.io/posts/reading-notes-newman-ch15/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Reading Notes: Newman's Networks Chapter 15 - Multilayer Networks",
  "name": "Reading Notes: Newman\u0027s Networks Chapter 15 - Multilayer Networks",
  "description": "Study notes for Chapter 15 of Newman's 'Networks: An Introduction' covering multilayer networks, multiplex networks, and their analysis",
  "keywords": [
    "reading-notes", "network-theory", "multilayer-networks", "multiplex-networks", "network-analysis"
  ],
  "articleBody": "Introduction Chapter 15 of Newmanâ€™s Networks: An Introduction explores multilayer networks - networks that consist of multiple layers, each representing different types of relationships or interactions. This chapter covers the mathematical framework, analysis methods, and applications of multilayer networks.\n15.1 Multilayer Network Structure Definition Multilayer network is a collection of networks with:\nNodes: Can exist in multiple layers Intra-layer edges: Connections within each layer Inter-layer edges: Connections between layers Layers: Different types of relationships or time periods Mathematical Representation Supra-adjacency Matrix Supra-adjacency matrix: $$A = \\bigoplus_{\\alpha} A^{\\alpha} + \\bigoplus_{\\alpha \\neq \\beta} C^{\\alpha \\beta}$$\nWhere:\n$A^{\\alpha}$: Adjacency matrix of layer $\\alpha$ $C^{\\alpha \\beta}$: Inter-layer coupling matrix $\\bigoplus$: Direct sum operator Tensor Representation Multilayer adjacency tensor: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} 1 \u0026 \\text{if } (i, \\alpha) \\text{ connected to } (j, \\beta) \\ 0 \u0026 \\text{otherwise} \\end{cases}$$\nProperties:\nDimensions: $n \\times n \\times L \\times L$ Symmetric: $A_{ij}^{\\alpha \\beta} = A_{ji}^{\\beta \\alpha}$ for undirected networks Sparse: Most entries are zero Types of Multilayer Networks Multiplex Networks Definition: Each layer represents a different type of relationship\nExample: Social network with layers for friendship, work, family\nMathematical representation: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} A_{ij}^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ 0 \u0026 \\text{if } \\alpha \\neq \\beta \\end{cases}$$\nTemporal Networks Definition: Each layer represents a different time period\nExample: Network evolution over time\nMathematical representation: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} A_{ij}^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ C_{ij}^{\\alpha \\beta} \u0026 \\text{if } |\\alpha - \\beta| = 1 \\ 0 \u0026 \\text{otherwise} \\end{cases}$$\nMultidimensional Networks Definition: Each layer represents a different dimension\nExample: Network with different interaction types\nMathematical representation: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} A_{ij}^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ C_{ij}^{\\alpha \\beta} \u0026 \\text{if } \\alpha \\neq \\beta \\end{cases}$$\n15.2 Multilayer Network Measures Degree Measures Multilayer Degree Multilayer degree of node $i$: $$k_i = \\sum_{\\alpha} k_i^{\\alpha}$$\nWhere $k_i^{\\alpha}$ is the degree of node $i$ in layer $\\alpha$.\nOverlapping Degree Overlapping degree of node $i$: $$o_i = \\sum_{\\alpha} \\mathbb{I}(k_i^{\\alpha} \u003e 0)$$\nWhere $\\mathbb{I}(\\cdot)$ is the indicator function.\nParticipation Coefficient Participation coefficient: $$P_i = 1 - \\sum_{\\alpha} \\left(\\frac{k_i^{\\alpha}}{k_i}\\right)^2$$\nProperties:\n$0 \\leq P_i \\leq 1$ $P_i = 0$: Node active in only one layer $P_i = 1$: Node equally active in all layers Clustering Measures Multilayer Clustering Multilayer clustering coefficient: $$C_i = \\frac{\\sum_{\\alpha} C_i^{\\alpha}}{L}$$\nWhere $C_i^{\\alpha}$ is the clustering coefficient of node $i$ in layer $\\alpha$.\nCross-layer Clustering Cross-layer clustering: $$C_i^{\\alpha \\beta} = \\frac{2e_i^{\\alpha \\beta}}{k_i^{\\alpha} k_i^{\\beta}}$$\nWhere $e_i^{\\alpha \\beta}$ is the number of edges between neighbors of node $i$ in layers $\\alpha$ and $\\beta$.\nCentrality Measures Multilayer PageRank Multilayer PageRank: $$PR_i^{\\alpha} = (1-d) \\frac{1}{nL} + d \\sum_{j, \\beta} \\frac{A_{ij}^{\\alpha \\beta} PR_j^{\\beta}}{k_j^{\\beta}}$$\nWhere:\n$d$: Damping factor $n$: Number of nodes $L$: Number of layers Multilayer Betweenness Multilayer betweenness centrality: $$C_B^{\\alpha}(i) = \\sum_{s \\neq i \\neq t} \\frac{\\sigma_{st}^{\\alpha}(i)}{\\sigma_{st}^{\\alpha}}$$\nWhere $\\sigma_{st}^{\\alpha}(i)$ is the number of shortest paths from $s$ to $t$ in layer $\\alpha$ passing through $i$.\n15.3 Multilayer Network Analysis Community Detection Multilayer Modularity Multilayer modularity: $$Q = \\frac{1}{2\\mu} \\sum_{ij \\alpha \\beta} \\left[ A_{ij}^{\\alpha \\beta} - \\frac{k_i^{\\alpha} k_j^{\\beta}}{2m^{\\alpha}} \\right] \\delta(c_i^{\\alpha}, c_j^{\\beta})$$\nWhere:\n$\\mu = \\sum_{i \\alpha} k_i^{\\alpha}$: Total number of edges $m^{\\alpha} = \\sum_i k_i^{\\alpha}$: Number of edges in layer $\\alpha$ $c_i^{\\alpha}$: Community assignment of node $i$ in layer $\\alpha$ Multilayer Spectral Clustering Multilayer Laplacian: $$L^{\\alpha \\beta} = D^{\\alpha \\beta} - A^{\\alpha \\beta}$$\nWhere $D^{\\alpha \\beta}$ is the degree matrix.\nEigenvalue decomposition: $$L = U \\Lambda U^T$$\nClustering: Use first $k$ eigenvectors to cluster nodes\nRandom Walks Multilayer Random Walk Transition probability: $$P_{ij}^{\\alpha \\beta} = \\frac{A_{ij}^{\\alpha \\beta}}{k_i^{\\alpha}}$$\nStationary distribution: $$\\pi_i^{\\alpha} = \\frac{k_i^{\\alpha}}{\\sum_{j \\beta} k_j^{\\beta}}$$\nMultilayer PageRank PageRank equation: $$\\pi_i^{\\alpha} = (1-d) \\frac{1}{nL} + d \\sum_{j \\beta} P_{ji}^{\\beta \\alpha} \\pi_j^{\\beta}$$\nSolution: Iterative method or eigenvalue problem\nSynchronization Multilayer Kuramoto Model Phase dynamics: $$\\frac{d\\theta_i^{\\alpha}}{dt} = \\omega_i^{\\alpha} + \\frac{K}{nL} \\sum_{j \\beta} A_{ij}^{\\alpha \\beta} \\sin(\\theta_j^{\\beta} - \\theta_i^{\\alpha})$$\nWhere:\n$\\theta_i^{\\alpha}$: Phase of node $i$ in layer $\\alpha$ $\\omega_i^{\\alpha}$: Natural frequency $K$: Coupling strength Order Parameter Multilayer order parameter: $$r = \\left| \\frac{1}{nL} \\sum_{i \\alpha} e^{i\\theta_i^{\\alpha}} \\right|$$\nLayer-specific order parameter: $$r^{\\alpha} = \\left| \\frac{1}{n} \\sum_{i} e^{i\\theta_i^{\\alpha}} \\right|$$\n15.4 Applications to Materials Science Multilayer Materials Composite Materials Network representation:\nLayer 1: Matrix material Layer 2: Filler material Layer 3: Interface region Inter-layer connections: Phase boundaries\nMathematical model: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} A_{ij}^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ C_{ij}^{\\alpha \\beta} \u0026 \\text{if } \\alpha \\neq \\beta \\end{cases}$$\nNanocomposite Materials Network structure:\nLayer 1: Carbon nanotubes Layer 2: Polymer matrix Layer 3: Interface interactions Properties:\nElectrical conductivity: Depends on inter-layer connections Mechanical strength: Depends on intra-layer connections Thermal conductivity: Depends on both types of connections Phase Transitions Multilayer Phase Transitions Network representation:\nLayer 1: Crystalline phase Layer 2: Amorphous phase Layer 3: Defect phase Phase transition dynamics: $$\\frac{d\\phi_i^{\\alpha}}{dt} = f_i^{\\alpha}(\\phi_i^{\\alpha}) + \\sum_{j \\beta} A_{ij}^{\\alpha \\beta} g_{ij}^{\\alpha \\beta}(\\phi_i^{\\alpha}, \\phi_j^{\\beta})$$\nWhere $\\phi_i^{\\alpha}$ is the order parameter of node $i$ in layer $\\alpha$.\nCritical Behavior Critical temperature: $$T_c = \\frac{K \\langle k^2 \\rangle}{\\langle k \\rangle}$$\nWhere $\\langle k \\rangle$ and $\\langle k^2 \\rangle$ are calculated across all layers.\nDefect Networks Multilayer Defect Networks Network representation:\nLayer 1: Point defects Layer 2: Line defects Layer 3: Surface defects Inter-layer connections: Defect interactions\nMathematical model: $$A_{ij}^{\\alpha \\beta} = \\begin{cases} A_{ij}^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ C_{ij}^{\\alpha \\beta} \u0026 \\text{if } \\alpha \\neq \\beta \\end{cases}$$\nDefect Clustering Multilayer clustering: $$C_i = \\frac{\\sum_{\\alpha} C_i^{\\alpha}}{L}$$\nCross-layer clustering: $$C_i^{\\alpha \\beta} = \\frac{2e_i^{\\alpha \\beta}}{k_i^{\\alpha} k_i^{\\beta}}$$\n15.5 Multilayer Network Models Random Multilayer Networks ErdÅ‘s-RÃ©nyi Multilayer Model: Each layer is an ErdÅ‘s-RÃ©nyi random graph\nParameters:\n$n$: Number of nodes $L$: Number of layers $p^{\\alpha}$: Edge probability in layer $\\alpha$ $p^{\\alpha \\beta}$: Inter-layer edge probability Mathematical formulation: $$P(A_{ij}^{\\alpha \\beta} = 1) = \\begin{cases} p^{\\alpha} \u0026 \\text{if } \\alpha = \\beta \\ p^{\\alpha \\beta} \u0026 \\text{if } \\alpha \\neq \\beta \\end{cases}$$\nScale-Free Multilayer Model: Each layer follows preferential attachment\nAlgorithm:\nStart with small initial network in each layer Add nodes with preferential attachment Add inter-layer edges with probability $p^{\\alpha \\beta}$ Degree distribution: $$P(k) \\sim k^{-\\gamma}$$\nWhere $\\gamma$ depends on the number of layers and inter-layer connections.\nMultilayer Community Models Stochastic Block Model Model: Nodes belong to communities across layers\nParameters:\n$c_i^{\\alpha}$: Community of node $i$ in layer $\\alpha$ $\\theta_{rs}^{\\alpha \\beta}$: Probability of edge between communities $r$ and $s$ in layers $\\alpha$ and $\\beta$ Mathematical formulation: $$P(A_{ij}^{\\alpha \\beta} = 1) = \\theta_{c_i^{\\alpha} c_j^{\\beta}}^{\\alpha \\beta}$$\nMultilayer Modularity Modularity: $$Q = \\frac{1}{2\\mu} \\sum_{ij \\alpha \\beta} \\left[ A_{ij}^{\\alpha \\beta} - \\frac{k_i^{\\alpha} k_j^{\\beta}}{2m^{\\alpha}} \\right] \\delta(c_i^{\\alpha}, c_j^{\\beta})$$\nOptimization: Maximize modularity to find communities\nCode Example: Multilayer Network Analysis import networkx as nx import numpy as np import matplotlib.pyplot as plt from collections import defaultdict from sklearn.cluster import SpectralClustering from scipy.sparse import csr_matrix class MultilayerNetwork: \"\"\"Multilayer network class\"\"\" def __init__(self, n_nodes, n_layers): self.n_nodes = n_nodes self.n_layers = n_layers self.layers = {} self.inter_layer_edges = defaultdict(list) # Initialize layers for layer in range(n_layers): self.layers[layer] = nx.Graph() for i in range(n_nodes): self.layers[layer].add_node(i) def add_intra_layer_edge(self, layer, u, v, weight=1): \"\"\"Add edge within a layer\"\"\" self.layers[layer].add_edge(u, v, weight=weight) def add_inter_layer_edge(self, layer1, layer2, u, v, weight=1): \"\"\"Add edge between layers\"\"\" self.inter_layer_edges[(layer1, layer2)].append((u, v, weight)) def get_supra_adjacency_matrix(self): \"\"\"Get supra-adjacency matrix\"\"\" n = self.n_nodes L = self.n_layers A = np.zeros((n * L, n * L)) # Intra-layer edges for layer in range(L): G = self.layers[layer] for u, v in G.edges(): weight = G[u][v].get('weight', 1) A[u * L + layer, v * L + layer] = weight A[v * L + layer, u * L + layer] = weight # Inter-layer edges for (layer1, layer2), edges in self.inter_layer_edges.items(): for u, v, weight in edges: A[u * L + layer1, v * L + layer2] = weight A[v * L + layer2, u * L + layer1] = weight return A def get_multilayer_degree(self, node): \"\"\"Get multilayer degree of a node\"\"\" degree = 0 for layer in self.layers: degree += self.layers[layer].degree(node) return degree def get_overlapping_degree(self, node): \"\"\"Get overlapping degree of a node\"\"\" overlapping = 0 for layer in self.layers: if self.layers[layer].degree(node) \u003e 0: overlapping += 1 return overlapping def get_participation_coefficient(self, node): \"\"\"Get participation coefficient of a node\"\"\" degrees = [self.layers[layer].degree(node) for layer in self.layers] total_degree = sum(degrees) if total_degree == 0: return 0 participation = 1 - sum((d / total_degree) ** 2 for d in degrees) return participation def get_multilayer_clustering(self, node): \"\"\"Get multilayer clustering coefficient of a node\"\"\" clusterings = [] for layer in self.layers: if self.layers[layer].degree(node) \u003e 1: clustering = nx.clustering(self.layers[layer], node) clusterings.append(clustering) if not clusterings: return 0 return np.mean(clusterings) def get_multilayer_pagerank(self, damping=0.85, max_iter=100, tol=1e-6): \"\"\"Get multilayer PageRank\"\"\" n = self.n_nodes L = self.n_layers # Initialize PageRank values pr = np.ones(n * L) / (n * L) # Get supra-adjacency matrix A = self.get_supra_adjacency_matrix() # Calculate transition matrix P = np.zeros_like(A) for i in range(n * L): row_sum = np.sum(A[i, :]) if row_sum \u003e 0: P[i, :] = A[i, :] / row_sum # Iterate PageRank for _ in range(max_iter): pr_new = (1 - damping) / (n * L) + damping * np.dot(P.T, pr) if np.linalg.norm(pr_new - pr) \u003c tol: break pr = pr_new # Reshape to node-layer format pr_reshaped = pr.reshape(n, L) return pr_reshaped def detect_communities(self, n_communities=3): \"\"\"Detect communities using spectral clustering\"\"\" A = self.get_supra_adjacency_matrix() # Spectral clustering clustering = SpectralClustering(n_clusters=n_communities, affinity='precomputed', random_state=42) labels = clustering.fit_predict(A) # Reshape to node-layer format labels_reshaped = labels.reshape(self.n_nodes, self.n_layers) return labels_reshaped def calculate_multilayer_modularity(self, communities): \"\"\"Calculate multilayer modularity\"\"\" n = self.n_nodes L = self.n_layers # Calculate total number of edges mu = 0 for layer in self.layers: mu += self.layers[layer].number_of_edges() # Calculate modularity Q = 0 for i in range(n): for j in range(n): for alpha in range(L): for beta in range(L): # Get edge weight if alpha == beta: # Intra-layer edge if self.layers[alpha].has_edge(i, j): A_ij = 1 else: A_ij = 0 else: # Inter-layer edge A_ij = 0 for (layer1, layer2), edges in self.inter_layer_edges.items(): if layer1 == alpha and layer2 == beta: for u, v, weight in edges: if u == i and v == j: A_ij = weight break # Get degrees k_i_alpha = self.layers[alpha].degree(i) k_j_beta = self.layers[beta].degree(j) # Get community assignments c_i_alpha = communities[i, alpha] c_j_beta = communities[j, beta] # Calculate modularity contribution if c_i_alpha == c_j_beta: Q += A_ij - (k_i_alpha * k_j_beta) / (2 * mu) return Q / (2 * mu) def generate_multilayer_network(n_nodes, n_layers, p_intra=0.1, p_inter=0.05): \"\"\"Generate random multilayer network\"\"\" # Create multilayer network ml_net = MultilayerNetwork(n_nodes, n_layers) # Add intra-layer edges for layer in range(n_layers): for i in range(n_nodes): for j in range(i+1, n_nodes): if np.random.random() \u003c p_intra: ml_net.add_intra_layer_edge(layer, i, j) # Add inter-layer edges for layer1 in range(n_layers): for layer2 in range(layer1+1, n_layers): for i in range(n_nodes): for j in range(n_nodes): if np.random.random() \u003c p_inter: ml_net.add_inter_layer_edge(layer1, layer2, i, j) return ml_net def analyze_multilayer_network(ml_net): \"\"\"Analyze multilayer network properties\"\"\" n = ml_net.n_nodes L = ml_net.n_layers # Calculate measures for each node measures = {} for i in range(n): measures[i] = { 'multilayer_degree': ml_net.get_multilayer_degree(i), 'overlapping_degree': ml_net.get_overlapping_degree(i), 'participation_coefficient': ml_net.get_participation_coefficient(i), 'multilayer_clustering': ml_net.get_multilayer_clustering(i) } # Calculate layer-specific measures layer_measures = {} for layer in range(L): G = ml_net.layers[layer] layer_measures[layer] = { 'nodes': G.number_of_nodes(), 'edges': G.number_of_edges(), 'density': nx.density(G), 'clustering': nx.average_clustering(G), 'avg_path_length': nx.average_shortest_path_length(G) if nx.is_connected(G) else float('inf') } return measures, layer_measures def plot_multilayer_analysis(ml_net, measures, layer_measures, communities): \"\"\"Plot multilayer network analysis\"\"\" fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12)) # Multilayer degree distribution degrees = [measures[i]['multilayer_degree'] for i in range(ml_net.n_nodes)] ax1.hist(degrees, bins=20, alpha=0.7, edgecolor='black') ax1.set_xlabel('Multilayer Degree') ax1.set_ylabel('Count') ax1.set_title('Multilayer Degree Distribution') ax1.grid(True, alpha=0.3) # Participation coefficient participation = [measures[i]['participation_coefficient'] for i in range(ml_net.n_nodes)] ax2.hist(participation, bins=20, alpha=0.7, edgecolor='black') ax2.set_xlabel('Participation Coefficient') ax2.set_ylabel('Count') ax2.set_title('Participation Coefficient Distribution') ax2.grid(True, alpha=0.3) # Layer comparison layers = list(layer_measures.keys()) densities = [layer_measures[layer]['density'] for layer in layers] clusterings = [layer_measures[layer]['clustering'] for layer in layers] ax3.scatter(densities, clusterings, s=100, alpha=0.7) for i, layer in enumerate(layers): ax3.annotate(f'Layer {layer}', (densities[i], clusterings[i])) ax3.set_xlabel('Density') ax3.set_ylabel('Clustering Coefficient') ax3.set_title('Layer Properties') ax3.grid(True, alpha=0.3) # Community structure n_communities = len(np.unique(communities)) community_sizes = [] for comm in range(n_communities): size = np.sum(communities == comm) community_sizes.append(size) ax4.bar(range(n_communities), community_sizes, alpha=0.7, color='skyblue') ax4.set_xlabel('Community') ax4.set_ylabel('Size') ax4.set_title('Community Size Distribution') ax4.grid(True, alpha=0.3) plt.tight_layout() plt.show() # Example: Multilayer network analysis n_nodes, n_layers = 50, 3 ml_net = generate_multilayer_network(n_nodes, n_layers, p_intra=0.1, p_inter=0.05) # Analyze network measures, layer_measures = analyze_multilayer_network(ml_net) # Detect communities communities = ml_net.detect_communities(n_communities=3) # Calculate modularity modularity = ml_net.calculate_multilayer_modularity(communities) # Get PageRank pagerank = ml_net.get_multilayer_pagerank() print(\"Multilayer Network Analysis:\") print(f\"Number of nodes: {n_nodes}\") print(f\"Number of layers: {n_layers}\") print(f\"Modularity: {modularity:.3f}\") print(\"\\nLayer Properties:\") for layer, props in layer_measures.items(): print(f\"Layer {layer}: {props['edges']} edges, density={props['density']:.3f}, clustering={props['clustering']:.3f}\") print(\"\\nNode Properties (first 5 nodes):\") for i in range(min(5, n_nodes)): print(f\"Node {i}: degree={measures[i]['multilayer_degree']}, participation={measures[i]['participation_coefficient']:.3f}\") # Plot analysis plot_multilayer_analysis(ml_net, measures, layer_measures, communities) Key Takeaways Multilayer networks: Networks with multiple layers of relationships Mathematical framework: Supra-adjacency matrix and tensor representations Network measures: Degree, clustering, and centrality measures for multilayer networks Community detection: Spectral clustering and modularity optimization Random walks: PageRank and other random walk methods Applications: Important for materials science and complex systems Analysis methods: Comprehensive tools for studying multilayer networks References Newman, M. E. J. (2010). Networks: An Introduction. Oxford University Press. KivelÃ¤, M., et al. (2014). Multilayer networks. Journal of Complex Networks, 2(3), 203-271. Boccaletti, S., et al. (2014). The structure and dynamics of multilayer networks. Physics Reports, 544(1), 1-122. De Domenico, M., et al. (2013). Mathematical formulation of multilayer networks. Physical Review X, 3(4), 041022. Multilayer networks provide a powerful framework for understanding complex systems with multiple types of relationships, with important applications in materials science and engineering.\n",
  "wordCount" : "2175",
  "inLanguage": "en",
  "datePublished": "2025-08-29T00:00:00Z",
  "dateModified": "2025-08-29T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Linlin-resh"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://Linlin-resh.github.io/posts/reading-notes-newman-ch15/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Notes on AI4Science \u0026 Graph Theory",
    "logo": {
      "@type": "ImageObject",
      "url": "https://Linlin-resh.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Linlin-resh.github.io/" accesskey="h" title="Notes on AI4Science &amp; Graph Theory (Alt + H)">Notes on AI4Science &amp; Graph Theory</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Linlin-resh.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://Linlin-resh.github.io/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://Linlin-resh.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://Linlin-resh.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://Linlin-resh.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks
    </h1>
    <div class="post-description">
      Study notes for Chapter 15 of Newman&#39;s &#39;Networks: An Introduction&#39; covering multilayer networks, multiplex networks, and their analysis
    </div>
    <div class="post-meta"><span title='2025-08-29 00:00:00 +0000 UTC'>August 29, 2025</span>&nbsp;Â·&nbsp;11 min&nbsp;Â·&nbsp;2175 words&nbsp;Â·&nbsp;Linlin-resh

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#151-multilayer-network-structure" aria-label="15.1 Multilayer Network Structure">15.1 Multilayer Network Structure</a><ul>
                        
                <li>
                    <a href="#definition" aria-label="Definition">Definition</a></li>
                <li>
                    <a href="#mathematical-representation" aria-label="Mathematical Representation">Mathematical Representation</a><ul>
                        
                <li>
                    <a href="#supra-adjacency-matrix" aria-label="Supra-adjacency Matrix">Supra-adjacency Matrix</a></li>
                <li>
                    <a href="#tensor-representation" aria-label="Tensor Representation">Tensor Representation</a></li></ul>
                </li>
                <li>
                    <a href="#types-of-multilayer-networks" aria-label="Types of Multilayer Networks">Types of Multilayer Networks</a><ul>
                        
                <li>
                    <a href="#multiplex-networks" aria-label="Multiplex Networks">Multiplex Networks</a></li>
                <li>
                    <a href="#temporal-networks" aria-label="Temporal Networks">Temporal Networks</a></li>
                <li>
                    <a href="#multidimensional-networks" aria-label="Multidimensional Networks">Multidimensional Networks</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#152-multilayer-network-measures" aria-label="15.2 Multilayer Network Measures">15.2 Multilayer Network Measures</a><ul>
                        
                <li>
                    <a href="#degree-measures" aria-label="Degree Measures">Degree Measures</a><ul>
                        
                <li>
                    <a href="#multilayer-degree" aria-label="Multilayer Degree">Multilayer Degree</a></li>
                <li>
                    <a href="#overlapping-degree" aria-label="Overlapping Degree">Overlapping Degree</a></li>
                <li>
                    <a href="#participation-coefficient" aria-label="Participation Coefficient">Participation Coefficient</a></li></ul>
                </li>
                <li>
                    <a href="#clustering-measures" aria-label="Clustering Measures">Clustering Measures</a><ul>
                        
                <li>
                    <a href="#multilayer-clustering" aria-label="Multilayer Clustering">Multilayer Clustering</a></li>
                <li>
                    <a href="#cross-layer-clustering" aria-label="Cross-layer Clustering">Cross-layer Clustering</a></li></ul>
                </li>
                <li>
                    <a href="#centrality-measures" aria-label="Centrality Measures">Centrality Measures</a><ul>
                        
                <li>
                    <a href="#multilayer-pagerank" aria-label="Multilayer PageRank">Multilayer PageRank</a></li>
                <li>
                    <a href="#multilayer-betweenness" aria-label="Multilayer Betweenness">Multilayer Betweenness</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#153-multilayer-network-analysis" aria-label="15.3 Multilayer Network Analysis">15.3 Multilayer Network Analysis</a><ul>
                        
                <li>
                    <a href="#community-detection" aria-label="Community Detection">Community Detection</a><ul>
                        
                <li>
                    <a href="#multilayer-modularity" aria-label="Multilayer Modularity">Multilayer Modularity</a></li>
                <li>
                    <a href="#multilayer-spectral-clustering" aria-label="Multilayer Spectral Clustering">Multilayer Spectral Clustering</a></li></ul>
                </li>
                <li>
                    <a href="#random-walks" aria-label="Random Walks">Random Walks</a><ul>
                        
                <li>
                    <a href="#multilayer-random-walk" aria-label="Multilayer Random Walk">Multilayer Random Walk</a></li>
                <li>
                    <a href="#multilayer-pagerank-1" aria-label="Multilayer PageRank">Multilayer PageRank</a></li></ul>
                </li>
                <li>
                    <a href="#synchronization" aria-label="Synchronization">Synchronization</a><ul>
                        
                <li>
                    <a href="#multilayer-kuramoto-model" aria-label="Multilayer Kuramoto Model">Multilayer Kuramoto Model</a></li>
                <li>
                    <a href="#order-parameter" aria-label="Order Parameter">Order Parameter</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#154-applications-to-materials-science" aria-label="15.4 Applications to Materials Science">15.4 Applications to Materials Science</a><ul>
                        
                <li>
                    <a href="#multilayer-materials" aria-label="Multilayer Materials">Multilayer Materials</a><ul>
                        
                <li>
                    <a href="#composite-materials" aria-label="Composite Materials">Composite Materials</a></li>
                <li>
                    <a href="#nanocomposite-materials" aria-label="Nanocomposite Materials">Nanocomposite Materials</a></li></ul>
                </li>
                <li>
                    <a href="#phase-transitions" aria-label="Phase Transitions">Phase Transitions</a><ul>
                        
                <li>
                    <a href="#multilayer-phase-transitions" aria-label="Multilayer Phase Transitions">Multilayer Phase Transitions</a></li>
                <li>
                    <a href="#critical-behavior" aria-label="Critical Behavior">Critical Behavior</a></li></ul>
                </li>
                <li>
                    <a href="#defect-networks" aria-label="Defect Networks">Defect Networks</a><ul>
                        
                <li>
                    <a href="#multilayer-defect-networks" aria-label="Multilayer Defect Networks">Multilayer Defect Networks</a></li>
                <li>
                    <a href="#defect-clustering" aria-label="Defect Clustering">Defect Clustering</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#155-multilayer-network-models" aria-label="15.5 Multilayer Network Models">15.5 Multilayer Network Models</a><ul>
                        
                <li>
                    <a href="#random-multilayer-networks" aria-label="Random Multilayer Networks">Random Multilayer Networks</a><ul>
                        
                <li>
                    <a href="#erd%c5%91s-r%c3%a9nyi-multilayer" aria-label="ErdÅ‘s-RÃ©nyi Multilayer">ErdÅ‘s-RÃ©nyi Multilayer</a></li>
                <li>
                    <a href="#scale-free-multilayer" aria-label="Scale-Free Multilayer">Scale-Free Multilayer</a></li></ul>
                </li>
                <li>
                    <a href="#multilayer-community-models" aria-label="Multilayer Community Models">Multilayer Community Models</a><ul>
                        
                <li>
                    <a href="#stochastic-block-model" aria-label="Stochastic Block Model">Stochastic Block Model</a></li>
                <li>
                    <a href="#multilayer-modularity-1" aria-label="Multilayer Modularity">Multilayer Modularity</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#code-example-multilayer-network-analysis" aria-label="Code Example: Multilayer Network Analysis">Code Example: Multilayer Network Analysis</a></li>
                <li>
                    <a href="#key-takeaways" aria-label="Key Takeaways">Key Takeaways</a></li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>Chapter 15 of Newman&rsquo;s <em>Networks: An Introduction</em> explores <strong>multilayer networks</strong> - networks that consist of multiple layers, each representing different types of relationships or interactions. This chapter covers the mathematical framework, analysis methods, and applications of multilayer networks.</p>
<h2 id="151-multilayer-network-structure">15.1 Multilayer Network Structure<a hidden class="anchor" aria-hidden="true" href="#151-multilayer-network-structure">#</a></h2>
<h3 id="definition">Definition<a hidden class="anchor" aria-hidden="true" href="#definition">#</a></h3>
<p><strong>Multilayer network</strong> is a collection of networks with:</p>
<ul>
<li><strong>Nodes</strong>: Can exist in multiple layers</li>
<li><strong>Intra-layer edges</strong>: Connections within each layer</li>
<li><strong>Inter-layer edges</strong>: Connections between layers</li>
<li><strong>Layers</strong>: Different types of relationships or time periods</li>
</ul>
<h3 id="mathematical-representation">Mathematical Representation<a hidden class="anchor" aria-hidden="true" href="#mathematical-representation">#</a></h3>
<h4 id="supra-adjacency-matrix">Supra-adjacency Matrix<a hidden class="anchor" aria-hidden="true" href="#supra-adjacency-matrix">#</a></h4>
<p><strong>Supra-adjacency matrix</strong>:
$$A = \bigoplus_{\alpha} A^{\alpha} + \bigoplus_{\alpha \neq \beta} C^{\alpha \beta}$$</p>
<p>Where:</p>
<ul>
<li>$A^{\alpha}$: Adjacency matrix of layer $\alpha$</li>
<li>$C^{\alpha \beta}$: Inter-layer coupling matrix</li>
<li>$\bigoplus$: Direct sum operator</li>
</ul>
<h4 id="tensor-representation">Tensor Representation<a hidden class="anchor" aria-hidden="true" href="#tensor-representation">#</a></h4>
<p><strong>Multilayer adjacency tensor</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
1 &amp; \text{if } (i, \alpha) \text{ connected to } (j, \beta) \
0 &amp; \text{otherwise}
\end{cases}$$</p>
<p><strong>Properties</strong>:</p>
<ul>
<li><strong>Dimensions</strong>: $n \times n \times L \times L$</li>
<li><strong>Symmetric</strong>: $A_{ij}^{\alpha \beta} = A_{ji}^{\beta \alpha}$ for undirected networks</li>
<li><strong>Sparse</strong>: Most entries are zero</li>
</ul>
<h3 id="types-of-multilayer-networks">Types of Multilayer Networks<a hidden class="anchor" aria-hidden="true" href="#types-of-multilayer-networks">#</a></h3>
<h4 id="multiplex-networks">Multiplex Networks<a hidden class="anchor" aria-hidden="true" href="#multiplex-networks">#</a></h4>
<p><strong>Definition</strong>: Each layer represents a different type of relationship</p>
<p><strong>Example</strong>: Social network with layers for friendship, work, family</p>
<p><strong>Mathematical representation</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
A_{ij}^{\alpha} &amp; \text{if } \alpha = \beta \
0 &amp; \text{if } \alpha \neq \beta
\end{cases}$$</p>
<h4 id="temporal-networks">Temporal Networks<a hidden class="anchor" aria-hidden="true" href="#temporal-networks">#</a></h4>
<p><strong>Definition</strong>: Each layer represents a different time period</p>
<p><strong>Example</strong>: Network evolution over time</p>
<p><strong>Mathematical representation</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
A_{ij}^{\alpha} &amp; \text{if } \alpha = \beta \
C_{ij}^{\alpha \beta} &amp; \text{if } |\alpha - \beta| = 1 \
0 &amp; \text{otherwise}
\end{cases}$$</p>
<h4 id="multidimensional-networks">Multidimensional Networks<a hidden class="anchor" aria-hidden="true" href="#multidimensional-networks">#</a></h4>
<p><strong>Definition</strong>: Each layer represents a different dimension</p>
<p><strong>Example</strong>: Network with different interaction types</p>
<p><strong>Mathematical representation</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
A_{ij}^{\alpha} &amp; \text{if } \alpha = \beta \
C_{ij}^{\alpha \beta} &amp; \text{if } \alpha \neq \beta
\end{cases}$$</p>
<h2 id="152-multilayer-network-measures">15.2 Multilayer Network Measures<a hidden class="anchor" aria-hidden="true" href="#152-multilayer-network-measures">#</a></h2>
<h3 id="degree-measures">Degree Measures<a hidden class="anchor" aria-hidden="true" href="#degree-measures">#</a></h3>
<h4 id="multilayer-degree">Multilayer Degree<a hidden class="anchor" aria-hidden="true" href="#multilayer-degree">#</a></h4>
<p><strong>Multilayer degree</strong> of node $i$:
$$k_i = \sum_{\alpha} k_i^{\alpha}$$</p>
<p>Where $k_i^{\alpha}$ is the degree of node $i$ in layer $\alpha$.</p>
<h4 id="overlapping-degree">Overlapping Degree<a hidden class="anchor" aria-hidden="true" href="#overlapping-degree">#</a></h4>
<p><strong>Overlapping degree</strong> of node $i$:
$$o_i = \sum_{\alpha} \mathbb{I}(k_i^{\alpha} &gt; 0)$$</p>
<p>Where $\mathbb{I}(\cdot)$ is the indicator function.</p>
<h4 id="participation-coefficient">Participation Coefficient<a hidden class="anchor" aria-hidden="true" href="#participation-coefficient">#</a></h4>
<p><strong>Participation coefficient</strong>:
$$P_i = 1 - \sum_{\alpha} \left(\frac{k_i^{\alpha}}{k_i}\right)^2$$</p>
<p><strong>Properties</strong>:</p>
<ul>
<li>$0 \leq P_i \leq 1$</li>
<li>$P_i = 0$: Node active in only one layer</li>
<li>$P_i = 1$: Node equally active in all layers</li>
</ul>
<h3 id="clustering-measures">Clustering Measures<a hidden class="anchor" aria-hidden="true" href="#clustering-measures">#</a></h3>
<h4 id="multilayer-clustering">Multilayer Clustering<a hidden class="anchor" aria-hidden="true" href="#multilayer-clustering">#</a></h4>
<p><strong>Multilayer clustering coefficient</strong>:
$$C_i = \frac{\sum_{\alpha} C_i^{\alpha}}{L}$$</p>
<p>Where $C_i^{\alpha}$ is the clustering coefficient of node $i$ in layer $\alpha$.</p>
<h4 id="cross-layer-clustering">Cross-layer Clustering<a hidden class="anchor" aria-hidden="true" href="#cross-layer-clustering">#</a></h4>
<p><strong>Cross-layer clustering</strong>:
$$C_i^{\alpha \beta} = \frac{2e_i^{\alpha \beta}}{k_i^{\alpha} k_i^{\beta}}$$</p>
<p>Where $e_i^{\alpha \beta}$ is the number of edges between neighbors of node $i$ in layers $\alpha$ and $\beta$.</p>
<h3 id="centrality-measures">Centrality Measures<a hidden class="anchor" aria-hidden="true" href="#centrality-measures">#</a></h3>
<h4 id="multilayer-pagerank">Multilayer PageRank<a hidden class="anchor" aria-hidden="true" href="#multilayer-pagerank">#</a></h4>
<p><strong>Multilayer PageRank</strong>:
$$PR_i^{\alpha} = (1-d) \frac{1}{nL} + d \sum_{j, \beta} \frac{A_{ij}^{\alpha \beta} PR_j^{\beta}}{k_j^{\beta}}$$</p>
<p>Where:</p>
<ul>
<li>$d$: Damping factor</li>
<li>$n$: Number of nodes</li>
<li>$L$: Number of layers</li>
</ul>
<h4 id="multilayer-betweenness">Multilayer Betweenness<a hidden class="anchor" aria-hidden="true" href="#multilayer-betweenness">#</a></h4>
<p><strong>Multilayer betweenness centrality</strong>:
$$C_B^{\alpha}(i) = \sum_{s \neq i \neq t} \frac{\sigma_{st}^{\alpha}(i)}{\sigma_{st}^{\alpha}}$$</p>
<p>Where $\sigma_{st}^{\alpha}(i)$ is the number of shortest paths from $s$ to $t$ in layer $\alpha$ passing through $i$.</p>
<h2 id="153-multilayer-network-analysis">15.3 Multilayer Network Analysis<a hidden class="anchor" aria-hidden="true" href="#153-multilayer-network-analysis">#</a></h2>
<h3 id="community-detection">Community Detection<a hidden class="anchor" aria-hidden="true" href="#community-detection">#</a></h3>
<h4 id="multilayer-modularity">Multilayer Modularity<a hidden class="anchor" aria-hidden="true" href="#multilayer-modularity">#</a></h4>
<p><strong>Multilayer modularity</strong>:
$$Q = \frac{1}{2\mu} \sum_{ij \alpha \beta} \left[ A_{ij}^{\alpha \beta} - \frac{k_i^{\alpha} k_j^{\beta}}{2m^{\alpha}} \right] \delta(c_i^{\alpha}, c_j^{\beta})$$</p>
<p>Where:</p>
<ul>
<li>$\mu = \sum_{i \alpha} k_i^{\alpha}$: Total number of edges</li>
<li>$m^{\alpha} = \sum_i k_i^{\alpha}$: Number of edges in layer $\alpha$</li>
<li>$c_i^{\alpha}$: Community assignment of node $i$ in layer $\alpha$</li>
</ul>
<h4 id="multilayer-spectral-clustering">Multilayer Spectral Clustering<a hidden class="anchor" aria-hidden="true" href="#multilayer-spectral-clustering">#</a></h4>
<p><strong>Multilayer Laplacian</strong>:
$$L^{\alpha \beta} = D^{\alpha \beta} - A^{\alpha \beta}$$</p>
<p>Where $D^{\alpha \beta}$ is the degree matrix.</p>
<p><strong>Eigenvalue decomposition</strong>:
$$L = U \Lambda U^T$$</p>
<p><strong>Clustering</strong>: Use first $k$ eigenvectors to cluster nodes</p>
<h3 id="random-walks">Random Walks<a hidden class="anchor" aria-hidden="true" href="#random-walks">#</a></h3>
<h4 id="multilayer-random-walk">Multilayer Random Walk<a hidden class="anchor" aria-hidden="true" href="#multilayer-random-walk">#</a></h4>
<p><strong>Transition probability</strong>:
$$P_{ij}^{\alpha \beta} = \frac{A_{ij}^{\alpha \beta}}{k_i^{\alpha}}$$</p>
<p><strong>Stationary distribution</strong>:
$$\pi_i^{\alpha} = \frac{k_i^{\alpha}}{\sum_{j \beta} k_j^{\beta}}$$</p>
<h4 id="multilayer-pagerank-1">Multilayer PageRank<a hidden class="anchor" aria-hidden="true" href="#multilayer-pagerank-1">#</a></h4>
<p><strong>PageRank equation</strong>:
$$\pi_i^{\alpha} = (1-d) \frac{1}{nL} + d \sum_{j \beta} P_{ji}^{\beta \alpha} \pi_j^{\beta}$$</p>
<p><strong>Solution</strong>: Iterative method or eigenvalue problem</p>
<h3 id="synchronization">Synchronization<a hidden class="anchor" aria-hidden="true" href="#synchronization">#</a></h3>
<h4 id="multilayer-kuramoto-model">Multilayer Kuramoto Model<a hidden class="anchor" aria-hidden="true" href="#multilayer-kuramoto-model">#</a></h4>
<p><strong>Phase dynamics</strong>:
$$\frac{d\theta_i^{\alpha}}{dt} = \omega_i^{\alpha} + \frac{K}{nL} \sum_{j \beta} A_{ij}^{\alpha \beta} \sin(\theta_j^{\beta} - \theta_i^{\alpha})$$</p>
<p>Where:</p>
<ul>
<li>$\theta_i^{\alpha}$: Phase of node $i$ in layer $\alpha$</li>
<li>$\omega_i^{\alpha}$: Natural frequency</li>
<li>$K$: Coupling strength</li>
</ul>
<h4 id="order-parameter">Order Parameter<a hidden class="anchor" aria-hidden="true" href="#order-parameter">#</a></h4>
<p><strong>Multilayer order parameter</strong>:
$$r = \left| \frac{1}{nL} \sum_{i \alpha} e^{i\theta_i^{\alpha}} \right|$$</p>
<p><strong>Layer-specific order parameter</strong>:
$$r^{\alpha} = \left| \frac{1}{n} \sum_{i} e^{i\theta_i^{\alpha}} \right|$$</p>
<h2 id="154-applications-to-materials-science">15.4 Applications to Materials Science<a hidden class="anchor" aria-hidden="true" href="#154-applications-to-materials-science">#</a></h2>
<h3 id="multilayer-materials">Multilayer Materials<a hidden class="anchor" aria-hidden="true" href="#multilayer-materials">#</a></h3>
<h4 id="composite-materials">Composite Materials<a hidden class="anchor" aria-hidden="true" href="#composite-materials">#</a></h4>
<p><strong>Network representation</strong>:</p>
<ul>
<li><strong>Layer 1</strong>: Matrix material</li>
<li><strong>Layer 2</strong>: Filler material</li>
<li><strong>Layer 3</strong>: Interface region</li>
</ul>
<p><strong>Inter-layer connections</strong>: Phase boundaries</p>
<p><strong>Mathematical model</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
A_{ij}^{\alpha} &amp; \text{if } \alpha = \beta \
C_{ij}^{\alpha \beta} &amp; \text{if } \alpha \neq \beta
\end{cases}$$</p>
<h4 id="nanocomposite-materials">Nanocomposite Materials<a hidden class="anchor" aria-hidden="true" href="#nanocomposite-materials">#</a></h4>
<p><strong>Network structure</strong>:</p>
<ul>
<li><strong>Layer 1</strong>: Carbon nanotubes</li>
<li><strong>Layer 2</strong>: Polymer matrix</li>
<li><strong>Layer 3</strong>: Interface interactions</li>
</ul>
<p><strong>Properties</strong>:</p>
<ul>
<li><strong>Electrical conductivity</strong>: Depends on inter-layer connections</li>
<li><strong>Mechanical strength</strong>: Depends on intra-layer connections</li>
<li><strong>Thermal conductivity</strong>: Depends on both types of connections</li>
</ul>
<h3 id="phase-transitions">Phase Transitions<a hidden class="anchor" aria-hidden="true" href="#phase-transitions">#</a></h3>
<h4 id="multilayer-phase-transitions">Multilayer Phase Transitions<a hidden class="anchor" aria-hidden="true" href="#multilayer-phase-transitions">#</a></h4>
<p><strong>Network representation</strong>:</p>
<ul>
<li><strong>Layer 1</strong>: Crystalline phase</li>
<li><strong>Layer 2</strong>: Amorphous phase</li>
<li><strong>Layer 3</strong>: Defect phase</li>
</ul>
<p><strong>Phase transition dynamics</strong>:
$$\frac{d\phi_i^{\alpha}}{dt} = f_i^{\alpha}(\phi_i^{\alpha}) + \sum_{j \beta} A_{ij}^{\alpha \beta} g_{ij}^{\alpha \beta}(\phi_i^{\alpha}, \phi_j^{\beta})$$</p>
<p>Where $\phi_i^{\alpha}$ is the order parameter of node $i$ in layer $\alpha$.</p>
<h4 id="critical-behavior">Critical Behavior<a hidden class="anchor" aria-hidden="true" href="#critical-behavior">#</a></h4>
<p><strong>Critical temperature</strong>:
$$T_c = \frac{K \langle k^2 \rangle}{\langle k \rangle}$$</p>
<p>Where $\langle k \rangle$ and $\langle k^2 \rangle$ are calculated across all layers.</p>
<h3 id="defect-networks">Defect Networks<a hidden class="anchor" aria-hidden="true" href="#defect-networks">#</a></h3>
<h4 id="multilayer-defect-networks">Multilayer Defect Networks<a hidden class="anchor" aria-hidden="true" href="#multilayer-defect-networks">#</a></h4>
<p><strong>Network representation</strong>:</p>
<ul>
<li><strong>Layer 1</strong>: Point defects</li>
<li><strong>Layer 2</strong>: Line defects</li>
<li><strong>Layer 3</strong>: Surface defects</li>
</ul>
<p><strong>Inter-layer connections</strong>: Defect interactions</p>
<p><strong>Mathematical model</strong>:
$$A_{ij}^{\alpha \beta} = \begin{cases}
A_{ij}^{\alpha} &amp; \text{if } \alpha = \beta \
C_{ij}^{\alpha \beta} &amp; \text{if } \alpha \neq \beta
\end{cases}$$</p>
<h4 id="defect-clustering">Defect Clustering<a hidden class="anchor" aria-hidden="true" href="#defect-clustering">#</a></h4>
<p><strong>Multilayer clustering</strong>:
$$C_i = \frac{\sum_{\alpha} C_i^{\alpha}}{L}$$</p>
<p><strong>Cross-layer clustering</strong>:
$$C_i^{\alpha \beta} = \frac{2e_i^{\alpha \beta}}{k_i^{\alpha} k_i^{\beta}}$$</p>
<h2 id="155-multilayer-network-models">15.5 Multilayer Network Models<a hidden class="anchor" aria-hidden="true" href="#155-multilayer-network-models">#</a></h2>
<h3 id="random-multilayer-networks">Random Multilayer Networks<a hidden class="anchor" aria-hidden="true" href="#random-multilayer-networks">#</a></h3>
<h4 id="erdÅ‘s-rÃ©nyi-multilayer">ErdÅ‘s-RÃ©nyi Multilayer<a hidden class="anchor" aria-hidden="true" href="#erdÅ‘s-rÃ©nyi-multilayer">#</a></h4>
<p><strong>Model</strong>: Each layer is an ErdÅ‘s-RÃ©nyi random graph</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li>$n$: Number of nodes</li>
<li>$L$: Number of layers</li>
<li>$p^{\alpha}$: Edge probability in layer $\alpha$</li>
<li>$p^{\alpha \beta}$: Inter-layer edge probability</li>
</ul>
<p><strong>Mathematical formulation</strong>:
$$P(A_{ij}^{\alpha \beta} = 1) = \begin{cases}
p^{\alpha} &amp; \text{if } \alpha = \beta \
p^{\alpha \beta} &amp; \text{if } \alpha \neq \beta
\end{cases}$$</p>
<h4 id="scale-free-multilayer">Scale-Free Multilayer<a hidden class="anchor" aria-hidden="true" href="#scale-free-multilayer">#</a></h4>
<p><strong>Model</strong>: Each layer follows preferential attachment</p>
<p><strong>Algorithm</strong>:</p>
<ol>
<li>Start with small initial network in each layer</li>
<li>Add nodes with preferential attachment</li>
<li>Add inter-layer edges with probability $p^{\alpha \beta}$</li>
</ol>
<p><strong>Degree distribution</strong>:
$$P(k) \sim k^{-\gamma}$$</p>
<p>Where $\gamma$ depends on the number of layers and inter-layer connections.</p>
<h3 id="multilayer-community-models">Multilayer Community Models<a hidden class="anchor" aria-hidden="true" href="#multilayer-community-models">#</a></h3>
<h4 id="stochastic-block-model">Stochastic Block Model<a hidden class="anchor" aria-hidden="true" href="#stochastic-block-model">#</a></h4>
<p><strong>Model</strong>: Nodes belong to communities across layers</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li>$c_i^{\alpha}$: Community of node $i$ in layer $\alpha$</li>
<li>$\theta_{rs}^{\alpha \beta}$: Probability of edge between communities $r$ and $s$ in layers $\alpha$ and $\beta$</li>
</ul>
<p><strong>Mathematical formulation</strong>:
$$P(A_{ij}^{\alpha \beta} = 1) = \theta_{c_i^{\alpha} c_j^{\beta}}^{\alpha \beta}$$</p>
<h4 id="multilayer-modularity-1">Multilayer Modularity<a hidden class="anchor" aria-hidden="true" href="#multilayer-modularity-1">#</a></h4>
<p><strong>Modularity</strong>:
$$Q = \frac{1}{2\mu} \sum_{ij \alpha \beta} \left[ A_{ij}^{\alpha \beta} - \frac{k_i^{\alpha} k_j^{\beta}}{2m^{\alpha}} \right] \delta(c_i^{\alpha}, c_j^{\beta})$$</p>
<p><strong>Optimization</strong>: Maximize modularity to find communities</p>
<h2 id="code-example-multilayer-network-analysis">Code Example: Multilayer Network Analysis<a hidden class="anchor" aria-hidden="true" href="#code-example-multilayer-network-analysis">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> networkx <span style="color:#ff79c6">as</span> nx
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> matplotlib.pyplot <span style="color:#ff79c6">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> collections <span style="color:#ff79c6">import</span> defaultdict
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> sklearn.cluster <span style="color:#ff79c6">import</span> SpectralClustering
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> scipy.sparse <span style="color:#ff79c6">import</span> csr_matrix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">MultilayerNetwork</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;Multilayer network class&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">__init__</span>(<span style="font-style:italic">self</span>, n_nodes, n_layers):
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_nodes <span style="color:#ff79c6">=</span> n_nodes
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_layers <span style="color:#ff79c6">=</span> n_layers
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers <span style="color:#ff79c6">=</span> {}
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>inter_layer_edges <span style="color:#ff79c6">=</span> defaultdict(<span style="color:#8be9fd;font-style:italic">list</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Initialize layers</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_layers):
</span></span><span style="display:flex;"><span>            <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer] <span style="color:#ff79c6">=</span> nx<span style="color:#ff79c6">.</span>Graph()
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_nodes):
</span></span><span style="display:flex;"><span>                <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>add_node(i)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">add_intra_layer_edge</span>(<span style="font-style:italic">self</span>, layer, u, v, weight<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Add edge within a layer&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>add_edge(u, v, weight<span style="color:#ff79c6">=</span>weight)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">add_inter_layer_edge</span>(<span style="font-style:italic">self</span>, layer1, layer2, u, v, weight<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Add edge between layers&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>inter_layer_edges[(layer1, layer2)]<span style="color:#ff79c6">.</span>append((u, v, weight))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_supra_adjacency_matrix</span>(<span style="font-style:italic">self</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get supra-adjacency matrix&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        n <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_nodes
</span></span><span style="display:flex;"><span>        L <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_layers
</span></span><span style="display:flex;"><span>        A <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>zeros((n <span style="color:#ff79c6">*</span> L, n <span style="color:#ff79c6">*</span> L))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Intra-layer edges</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(L):
</span></span><span style="display:flex;"><span>            G <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> u, v <span style="color:#ff79c6">in</span> G<span style="color:#ff79c6">.</span>edges():
</span></span><span style="display:flex;"><span>                weight <span style="color:#ff79c6">=</span> G[u][v]<span style="color:#ff79c6">.</span>get(<span style="color:#f1fa8c">&#39;weight&#39;</span>, <span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>                A[u <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer, v <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer] <span style="color:#ff79c6">=</span> weight
</span></span><span style="display:flex;"><span>                A[v <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer, u <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer] <span style="color:#ff79c6">=</span> weight
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Inter-layer edges</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> (layer1, layer2), edges <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>inter_layer_edges<span style="color:#ff79c6">.</span>items():
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> u, v, weight <span style="color:#ff79c6">in</span> edges:
</span></span><span style="display:flex;"><span>                A[u <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer1, v <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer2] <span style="color:#ff79c6">=</span> weight
</span></span><span style="display:flex;"><span>                A[v <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer2, u <span style="color:#ff79c6">*</span> L <span style="color:#ff79c6">+</span> layer1] <span style="color:#ff79c6">=</span> weight
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> A
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_multilayer_degree</span>(<span style="font-style:italic">self</span>, node):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get multilayer degree of a node&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        degree <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers:
</span></span><span style="display:flex;"><span>            degree <span style="color:#ff79c6">+=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>degree(node)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> degree
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_overlapping_degree</span>(<span style="font-style:italic">self</span>, node):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get overlapping degree of a node&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        overlapping <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>degree(node) <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>                overlapping <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> overlapping
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_participation_coefficient</span>(<span style="font-style:italic">self</span>, node):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get participation coefficient of a node&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        degrees <span style="color:#ff79c6">=</span> [<span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>degree(node) <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers]
</span></span><span style="display:flex;"><span>        total_degree <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">sum</span>(degrees)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> total_degree <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        participation <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">sum</span>((d <span style="color:#ff79c6">/</span> total_degree) <span style="color:#ff79c6">**</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">for</span> d <span style="color:#ff79c6">in</span> degrees)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> participation
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_multilayer_clustering</span>(<span style="font-style:italic">self</span>, node):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get multilayer clustering coefficient of a node&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        clusterings <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>degree(node) <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">1</span>:
</span></span><span style="display:flex;"><span>                clustering <span style="color:#ff79c6">=</span> nx<span style="color:#ff79c6">.</span>clustering(<span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer], node)
</span></span><span style="display:flex;"><span>                clusterings<span style="color:#ff79c6">.</span>append(clustering)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> clusterings:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> np<span style="color:#ff79c6">.</span>mean(clusterings)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_multilayer_pagerank</span>(<span style="font-style:italic">self</span>, damping<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.85</span>, max_iter<span style="color:#ff79c6">=</span><span style="color:#bd93f9">100</span>, tol<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1e-6</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Get multilayer PageRank&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        n <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_nodes
</span></span><span style="display:flex;"><span>        L <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_layers
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Initialize PageRank values</span>
</span></span><span style="display:flex;"><span>        pr <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>ones(n <span style="color:#ff79c6">*</span> L) <span style="color:#ff79c6">/</span> (n <span style="color:#ff79c6">*</span> L)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Get supra-adjacency matrix</span>
</span></span><span style="display:flex;"><span>        A <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>get_supra_adjacency_matrix()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Calculate transition matrix</span>
</span></span><span style="display:flex;"><span>        P <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>zeros_like(A)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n <span style="color:#ff79c6">*</span> L):
</span></span><span style="display:flex;"><span>            row_sum <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>sum(A[i, :])
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> row_sum <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>                P[i, :] <span style="color:#ff79c6">=</span> A[i, :] <span style="color:#ff79c6">/</span> row_sum
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Iterate PageRank</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(max_iter):
</span></span><span style="display:flex;"><span>            pr_new <span style="color:#ff79c6">=</span> (<span style="color:#bd93f9">1</span> <span style="color:#ff79c6">-</span> damping) <span style="color:#ff79c6">/</span> (n <span style="color:#ff79c6">*</span> L) <span style="color:#ff79c6">+</span> damping <span style="color:#ff79c6">*</span> np<span style="color:#ff79c6">.</span>dot(P<span style="color:#ff79c6">.</span>T, pr)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> np<span style="color:#ff79c6">.</span>linalg<span style="color:#ff79c6">.</span>norm(pr_new <span style="color:#ff79c6">-</span> pr) <span style="color:#ff79c6">&lt;</span> tol:
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">break</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            pr <span style="color:#ff79c6">=</span> pr_new
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Reshape to node-layer format</span>
</span></span><span style="display:flex;"><span>        pr_reshaped <span style="color:#ff79c6">=</span> pr<span style="color:#ff79c6">.</span>reshape(n, L)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> pr_reshaped
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">detect_communities</span>(<span style="font-style:italic">self</span>, n_communities<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Detect communities using spectral clustering&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        A <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>get_supra_adjacency_matrix()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Spectral clustering</span>
</span></span><span style="display:flex;"><span>        clustering <span style="color:#ff79c6">=</span> SpectralClustering(n_clusters<span style="color:#ff79c6">=</span>n_communities, 
</span></span><span style="display:flex;"><span>                                      affinity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;precomputed&#39;</span>,
</span></span><span style="display:flex;"><span>                                      random_state<span style="color:#ff79c6">=</span><span style="color:#bd93f9">42</span>)
</span></span><span style="display:flex;"><span>        labels <span style="color:#ff79c6">=</span> clustering<span style="color:#ff79c6">.</span>fit_predict(A)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Reshape to node-layer format</span>
</span></span><span style="display:flex;"><span>        labels_reshaped <span style="color:#ff79c6">=</span> labels<span style="color:#ff79c6">.</span>reshape(<span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_nodes, <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_layers)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> labels_reshaped
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">def</span> <span style="color:#50fa7b">calculate_multilayer_modularity</span>(<span style="font-style:italic">self</span>, communities):
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;&#34;&#34;Calculate multilayer modularity&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        n <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_nodes
</span></span><span style="display:flex;"><span>        L <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>n_layers
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Calculate total number of edges</span>
</span></span><span style="display:flex;"><span>        mu <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers:
</span></span><span style="display:flex;"><span>            mu <span style="color:#ff79c6">+=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[layer]<span style="color:#ff79c6">.</span>number_of_edges()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Calculate modularity</span>
</span></span><span style="display:flex;"><span>        Q <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n):
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n):
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">for</span> alpha <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(L):
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">for</span> beta <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(L):
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4"># Get edge weight</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">if</span> alpha <span style="color:#ff79c6">==</span> beta:
</span></span><span style="display:flex;"><span>                            <span style="color:#6272a4"># Intra-layer edge</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">if</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[alpha]<span style="color:#ff79c6">.</span>has_edge(i, j):
</span></span><span style="display:flex;"><span>                                A_ij <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>                                A_ij <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>                            <span style="color:#6272a4"># Inter-layer edge</span>
</span></span><span style="display:flex;"><span>                            A_ij <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">for</span> (layer1, layer2), edges <span style="color:#ff79c6">in</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>inter_layer_edges<span style="color:#ff79c6">.</span>items():
</span></span><span style="display:flex;"><span>                                <span style="color:#ff79c6">if</span> layer1 <span style="color:#ff79c6">==</span> alpha <span style="color:#ff79c6">and</span> layer2 <span style="color:#ff79c6">==</span> beta:
</span></span><span style="display:flex;"><span>                                    <span style="color:#ff79c6">for</span> u, v, weight <span style="color:#ff79c6">in</span> edges:
</span></span><span style="display:flex;"><span>                                        <span style="color:#ff79c6">if</span> u <span style="color:#ff79c6">==</span> i <span style="color:#ff79c6">and</span> v <span style="color:#ff79c6">==</span> j:
</span></span><span style="display:flex;"><span>                                            A_ij <span style="color:#ff79c6">=</span> weight
</span></span><span style="display:flex;"><span>                                            <span style="color:#ff79c6">break</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4"># Get degrees</span>
</span></span><span style="display:flex;"><span>                        k_i_alpha <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[alpha]<span style="color:#ff79c6">.</span>degree(i)
</span></span><span style="display:flex;"><span>                        k_j_beta <span style="color:#ff79c6">=</span> <span style="font-style:italic">self</span><span style="color:#ff79c6">.</span>layers[beta]<span style="color:#ff79c6">.</span>degree(j)
</span></span><span style="display:flex;"><span>                        
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4"># Get community assignments</span>
</span></span><span style="display:flex;"><span>                        c_i_alpha <span style="color:#ff79c6">=</span> communities[i, alpha]
</span></span><span style="display:flex;"><span>                        c_j_beta <span style="color:#ff79c6">=</span> communities[j, beta]
</span></span><span style="display:flex;"><span>                        
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4"># Calculate modularity contribution</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">if</span> c_i_alpha <span style="color:#ff79c6">==</span> c_j_beta:
</span></span><span style="display:flex;"><span>                            Q <span style="color:#ff79c6">+=</span> A_ij <span style="color:#ff79c6">-</span> (k_i_alpha <span style="color:#ff79c6">*</span> k_j_beta) <span style="color:#ff79c6">/</span> (<span style="color:#bd93f9">2</span> <span style="color:#ff79c6">*</span> mu)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> Q <span style="color:#ff79c6">/</span> (<span style="color:#bd93f9">2</span> <span style="color:#ff79c6">*</span> mu)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">generate_multilayer_network</span>(n_nodes, n_layers, p_intra<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.1</span>, p_inter<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.05</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;Generate random multilayer network&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Create multilayer network</span>
</span></span><span style="display:flex;"><span>    ml_net <span style="color:#ff79c6">=</span> MultilayerNetwork(n_nodes, n_layers)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Add intra-layer edges</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_layers):
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_nodes):
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>, n_nodes):
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">if</span> np<span style="color:#ff79c6">.</span>random<span style="color:#ff79c6">.</span>random() <span style="color:#ff79c6">&lt;</span> p_intra:
</span></span><span style="display:flex;"><span>                    ml_net<span style="color:#ff79c6">.</span>add_intra_layer_edge(layer, i, j)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Add inter-layer edges</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> layer1 <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_layers):
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> layer2 <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(layer1<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>, n_layers):
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_nodes):
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_nodes):
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">if</span> np<span style="color:#ff79c6">.</span>random<span style="color:#ff79c6">.</span>random() <span style="color:#ff79c6">&lt;</span> p_inter:
</span></span><span style="display:flex;"><span>                        ml_net<span style="color:#ff79c6">.</span>add_inter_layer_edge(layer1, layer2, i, j)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> ml_net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">analyze_multilayer_network</span>(ml_net):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;Analyze multilayer network properties&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    n <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>n_nodes
</span></span><span style="display:flex;"><span>    L <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>n_layers
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Calculate measures for each node</span>
</span></span><span style="display:flex;"><span>    measures <span style="color:#ff79c6">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n):
</span></span><span style="display:flex;"><span>        measures[i] <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;multilayer_degree&#39;</span>: ml_net<span style="color:#ff79c6">.</span>get_multilayer_degree(i),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;overlapping_degree&#39;</span>: ml_net<span style="color:#ff79c6">.</span>get_overlapping_degree(i),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;participation_coefficient&#39;</span>: ml_net<span style="color:#ff79c6">.</span>get_participation_coefficient(i),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;multilayer_clustering&#39;</span>: ml_net<span style="color:#ff79c6">.</span>get_multilayer_clustering(i)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Calculate layer-specific measures</span>
</span></span><span style="display:flex;"><span>    layer_measures <span style="color:#ff79c6">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(L):
</span></span><span style="display:flex;"><span>        G <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>layers[layer]
</span></span><span style="display:flex;"><span>        layer_measures[layer] <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;nodes&#39;</span>: G<span style="color:#ff79c6">.</span>number_of_nodes(),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;edges&#39;</span>: G<span style="color:#ff79c6">.</span>number_of_edges(),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;density&#39;</span>: nx<span style="color:#ff79c6">.</span>density(G),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;clustering&#39;</span>: nx<span style="color:#ff79c6">.</span>average_clustering(G),
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;avg_path_length&#39;</span>: nx<span style="color:#ff79c6">.</span>average_shortest_path_length(G) <span style="color:#ff79c6">if</span> nx<span style="color:#ff79c6">.</span>is_connected(G) <span style="color:#ff79c6">else</span> <span style="color:#8be9fd;font-style:italic">float</span>(<span style="color:#f1fa8c">&#39;inf&#39;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> measures, layer_measures
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">plot_multilayer_analysis</span>(ml_net, measures, layer_measures, communities):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;Plot multilayer network analysis&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    fig, ((ax1, ax2), (ax3, ax4)) <span style="color:#ff79c6">=</span> plt<span style="color:#ff79c6">.</span>subplots(<span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">2</span>, figsize<span style="color:#ff79c6">=</span>(<span style="color:#bd93f9">15</span>, <span style="color:#bd93f9">12</span>))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Multilayer degree distribution</span>
</span></span><span style="display:flex;"><span>    degrees <span style="color:#ff79c6">=</span> [measures[i][<span style="color:#f1fa8c">&#39;multilayer_degree&#39;</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(ml_net<span style="color:#ff79c6">.</span>n_nodes)]
</span></span><span style="display:flex;"><span>    ax1<span style="color:#ff79c6">.</span>hist(degrees, bins<span style="color:#ff79c6">=</span><span style="color:#bd93f9">20</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.7</span>, edgecolor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>    ax1<span style="color:#ff79c6">.</span>set_xlabel(<span style="color:#f1fa8c">&#39;Multilayer Degree&#39;</span>)
</span></span><span style="display:flex;"><span>    ax1<span style="color:#ff79c6">.</span>set_ylabel(<span style="color:#f1fa8c">&#39;Count&#39;</span>)
</span></span><span style="display:flex;"><span>    ax1<span style="color:#ff79c6">.</span>set_title(<span style="color:#f1fa8c">&#39;Multilayer Degree Distribution&#39;</span>)
</span></span><span style="display:flex;"><span>    ax1<span style="color:#ff79c6">.</span>grid(<span style="color:#ff79c6">True</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.3</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Participation coefficient</span>
</span></span><span style="display:flex;"><span>    participation <span style="color:#ff79c6">=</span> [measures[i][<span style="color:#f1fa8c">&#39;participation_coefficient&#39;</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(ml_net<span style="color:#ff79c6">.</span>n_nodes)]
</span></span><span style="display:flex;"><span>    ax2<span style="color:#ff79c6">.</span>hist(participation, bins<span style="color:#ff79c6">=</span><span style="color:#bd93f9">20</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.7</span>, edgecolor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>    ax2<span style="color:#ff79c6">.</span>set_xlabel(<span style="color:#f1fa8c">&#39;Participation Coefficient&#39;</span>)
</span></span><span style="display:flex;"><span>    ax2<span style="color:#ff79c6">.</span>set_ylabel(<span style="color:#f1fa8c">&#39;Count&#39;</span>)
</span></span><span style="display:flex;"><span>    ax2<span style="color:#ff79c6">.</span>set_title(<span style="color:#f1fa8c">&#39;Participation Coefficient Distribution&#39;</span>)
</span></span><span style="display:flex;"><span>    ax2<span style="color:#ff79c6">.</span>grid(<span style="color:#ff79c6">True</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.3</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Layer comparison</span>
</span></span><span style="display:flex;"><span>    layers <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">list</span>(layer_measures<span style="color:#ff79c6">.</span>keys())
</span></span><span style="display:flex;"><span>    densities <span style="color:#ff79c6">=</span> [layer_measures[layer][<span style="color:#f1fa8c">&#39;density&#39;</span>] <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> layers]
</span></span><span style="display:flex;"><span>    clusterings <span style="color:#ff79c6">=</span> [layer_measures[layer][<span style="color:#f1fa8c">&#39;clustering&#39;</span>] <span style="color:#ff79c6">for</span> layer <span style="color:#ff79c6">in</span> layers]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ax3<span style="color:#ff79c6">.</span>scatter(densities, clusterings, s<span style="color:#ff79c6">=</span><span style="color:#bd93f9">100</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.7</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> i, layer <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">enumerate</span>(layers):
</span></span><span style="display:flex;"><span>        ax3<span style="color:#ff79c6">.</span>annotate(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;Layer </span><span style="color:#f1fa8c">{</span>layer<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>, (densities[i], clusterings[i]))
</span></span><span style="display:flex;"><span>    ax3<span style="color:#ff79c6">.</span>set_xlabel(<span style="color:#f1fa8c">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>    ax3<span style="color:#ff79c6">.</span>set_ylabel(<span style="color:#f1fa8c">&#39;Clustering Coefficient&#39;</span>)
</span></span><span style="display:flex;"><span>    ax3<span style="color:#ff79c6">.</span>set_title(<span style="color:#f1fa8c">&#39;Layer Properties&#39;</span>)
</span></span><span style="display:flex;"><span>    ax3<span style="color:#ff79c6">.</span>grid(<span style="color:#ff79c6">True</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.3</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Community structure</span>
</span></span><span style="display:flex;"><span>    n_communities <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(np<span style="color:#ff79c6">.</span>unique(communities))
</span></span><span style="display:flex;"><span>    community_sizes <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> comm <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(n_communities):
</span></span><span style="display:flex;"><span>        size <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>sum(communities <span style="color:#ff79c6">==</span> comm)
</span></span><span style="display:flex;"><span>        community_sizes<span style="color:#ff79c6">.</span>append(size)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ax4<span style="color:#ff79c6">.</span>bar(<span style="color:#8be9fd;font-style:italic">range</span>(n_communities), community_sizes, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.7</span>, color<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;skyblue&#39;</span>)
</span></span><span style="display:flex;"><span>    ax4<span style="color:#ff79c6">.</span>set_xlabel(<span style="color:#f1fa8c">&#39;Community&#39;</span>)
</span></span><span style="display:flex;"><span>    ax4<span style="color:#ff79c6">.</span>set_ylabel(<span style="color:#f1fa8c">&#39;Size&#39;</span>)
</span></span><span style="display:flex;"><span>    ax4<span style="color:#ff79c6">.</span>set_title(<span style="color:#f1fa8c">&#39;Community Size Distribution&#39;</span>)
</span></span><span style="display:flex;"><span>    ax4<span style="color:#ff79c6">.</span>grid(<span style="color:#ff79c6">True</span>, alpha<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.3</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#ff79c6">.</span>tight_layout()
</span></span><span style="display:flex;"><span>    plt<span style="color:#ff79c6">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Example: Multilayer network analysis</span>
</span></span><span style="display:flex;"><span>n_nodes, n_layers <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">50</span>, <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span>ml_net <span style="color:#ff79c6">=</span> generate_multilayer_network(n_nodes, n_layers, p_intra<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.1</span>, p_inter<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0.05</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Analyze network</span>
</span></span><span style="display:flex;"><span>measures, layer_measures <span style="color:#ff79c6">=</span> analyze_multilayer_network(ml_net)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Detect communities</span>
</span></span><span style="display:flex;"><span>communities <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>detect_communities(n_communities<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Calculate modularity</span>
</span></span><span style="display:flex;"><span>modularity <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>calculate_multilayer_modularity(communities)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Get PageRank</span>
</span></span><span style="display:flex;"><span>pagerank <span style="color:#ff79c6">=</span> ml_net<span style="color:#ff79c6">.</span>get_multilayer_pagerank()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Multilayer Network Analysis:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Number of nodes: </span><span style="color:#f1fa8c">{</span>n_nodes<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Number of layers: </span><span style="color:#f1fa8c">{</span>n_layers<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Modularity: </span><span style="color:#f1fa8c">{</span>modularity<span style="color:#f1fa8c">:</span><span style="color:#f1fa8c">.3f</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">Layer Properties:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> layer, props <span style="color:#ff79c6">in</span> layer_measures<span style="color:#ff79c6">.</span>items():
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Layer </span><span style="color:#f1fa8c">{</span>layer<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">: </span><span style="color:#f1fa8c">{</span>props[<span style="color:#f1fa8c">&#39;edges&#39;</span>]<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> edges, density=</span><span style="color:#f1fa8c">{</span>props[<span style="color:#f1fa8c">&#39;density&#39;</span>]<span style="color:#f1fa8c">:</span><span style="color:#f1fa8c">.3f</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">, clustering=</span><span style="color:#f1fa8c">{</span>props[<span style="color:#f1fa8c">&#39;clustering&#39;</span>]<span style="color:#f1fa8c">:</span><span style="color:#f1fa8c">.3f</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">Node Properties (first 5 nodes):&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#8be9fd;font-style:italic">min</span>(<span style="color:#bd93f9">5</span>, n_nodes)):
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Node </span><span style="color:#f1fa8c">{</span>i<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">: degree=</span><span style="color:#f1fa8c">{</span>measures[i][<span style="color:#f1fa8c">&#39;multilayer_degree&#39;</span>]<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">, participation=</span><span style="color:#f1fa8c">{</span>measures[i][<span style="color:#f1fa8c">&#39;participation_coefficient&#39;</span>]<span style="color:#f1fa8c">:</span><span style="color:#f1fa8c">.3f</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Plot analysis</span>
</span></span><span style="display:flex;"><span>plot_multilayer_analysis(ml_net, measures, layer_measures, communities)
</span></span></code></pre></div><h2 id="key-takeaways">Key Takeaways<a hidden class="anchor" aria-hidden="true" href="#key-takeaways">#</a></h2>
<ol>
<li><strong>Multilayer networks</strong>: Networks with multiple layers of relationships</li>
<li><strong>Mathematical framework</strong>: Supra-adjacency matrix and tensor representations</li>
<li><strong>Network measures</strong>: Degree, clustering, and centrality measures for multilayer networks</li>
<li><strong>Community detection</strong>: Spectral clustering and modularity optimization</li>
<li><strong>Random walks</strong>: PageRank and other random walk methods</li>
<li><strong>Applications</strong>: Important for materials science and complex systems</li>
<li><strong>Analysis methods</strong>: Comprehensive tools for studying multilayer networks</li>
</ol>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ol>
<li>Newman, M. E. J. (2010). Networks: An Introduction. Oxford University Press.</li>
<li>KivelÃ¤, M., et al. (2014). Multilayer networks. Journal of Complex Networks, 2(3), 203-271.</li>
<li>Boccaletti, S., et al. (2014). The structure and dynamics of multilayer networks. Physics Reports, 544(1), 1-122.</li>
<li>De Domenico, M., et al. (2013). Mathematical formulation of multilayer networks. Physical Review X, 3(4), 041022.</li>
</ol>
<hr>
<p><em>Multilayer networks provide a powerful framework for understanding complex systems with multiple types of relationships, with important applications in materials science and engineering.</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://Linlin-resh.github.io/tags/reading-notes/">Reading-Notes</a></li>
      <li><a href="https://Linlin-resh.github.io/tags/network-theory/">Network-Theory</a></li>
      <li><a href="https://Linlin-resh.github.io/tags/multilayer-networks/">Multilayer-Networks</a></li>
      <li><a href="https://Linlin-resh.github.io/tags/multiplex-networks/">Multiplex-Networks</a></li>
      <li><a href="https://Linlin-resh.github.io/tags/network-analysis/">Network-Analysis</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on x"
            href="https://x.com/intent/tweet/?text=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks&amp;url=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f&amp;hashtags=reading-notes%2cnetwork-theory%2cmultilayer-networks%2cmultiplex-networks%2cnetwork-analysis">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f&amp;title=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks&amp;summary=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks&amp;source=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f&title=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on whatsapp"
            href="https://api.whatsapp.com/send?text=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks%20-%20https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on telegram"
            href="https://telegram.me/share/url?text=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks&amp;url=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Reading Notes: Newman&#39;s Networks Chapter 15 - Multilayer Networks on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Reading%20Notes%3a%20Newman%27s%20Networks%20Chapter%2015%20-%20Multilayer%20Networks&u=https%3a%2f%2fLinlin-resh.github.io%2fposts%2freading-notes-newman-ch15%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://Linlin-resh.github.io/">Notes on AI4Science &amp; Graph Theory</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
